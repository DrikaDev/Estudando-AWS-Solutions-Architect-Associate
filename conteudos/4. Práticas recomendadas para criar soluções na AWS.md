## Práticas recomendadas para criar soluções na AWS

Ao projetar uma solução, é essencial avaliar cuidadosamente as **vantagens e desvantagens** para escolher a abordagem ideal.  
Em alguns cenários, é possível abrir mão de **consistência**, **durabilidade** ou **espaço** em troca de **menor latência** e **melhor desempenho**.  
Em outros, a prioridade pode ser a **velocidade de comercialização (time-to-market)**, mesmo que isso resulte em um custo inicial maior.

Essas decisões impactam diretamente o **custo**, a **performance** e a **complexidade** da arquitetura.  
Por isso, o design deve sempre se apoiar em **dados empíricos** - informações obtidas por observação real, experimentos, medições ou testes práticos, e não por suposições, opiniões ou teorias - como:

- **Testes de carga** para validar ganhos reais de desempenho.  
- **Benchmarking** para identificar a solução mais econômica ao longo do tempo.

Ao buscar otimizações, considere também como cada escolha afetará:

- A experiência dos clientes  
- A eficiência do workload  
- A escalabilidade e a manutenção da solução

Nesta seção, você verá:

- **Práticas recomendadas** para projetar arquiteturas na AWS  
- **Antipadrões** — abordagens que devem ser evitadas

Em resumo, projetar bem significa **equilibrar trade-offs** e tomar decisões baseadas em evidências — métricas, testes, medições e impacto real no workload e nos usuários.

A seguir, você encontra as principais práticas para criar soluções eficientes, resilientes e econômicas na nuvem.

---

### 1. Implementar a Escalabilidade

Garanta que sua arquitetura consiga lidar com alterações de demanda de forma rápida, automática e proativa.

Com a AWS, é possível escalar a infraestrutura com antecedência, evitando gargalos. Para isso:

- Implemente escalabilidade em **todas as camadas**.
- Use o **Amazon CloudWatch** para monitorar métricas e acionar políticas de scaling.
- Defina limites como:  
  *“CPU acima de 60% por mais de 5 minutos.”*
- Utilize métricas personalizadas para workloads específicos.
- Configure o **Amazon EC2 Auto Scaling** para iniciar novas instâncias automaticamente quando necessário.

Quando um alarme é acionado, uma nova instância é iniciada **antes** da saturação, garantindo uma experiência contínua para os usuários.

Da mesma forma, quando a demanda diminui, o Auto Scaling reduz a capacidade — evitando custos desnecessários.

#### Antipadrão a evitar
Escalonar manualmente e de forma reativa.  
Quando a capacidade estoura, usuários passam a não conseguir acessar a aplicação, e novas instâncias demoram minutos para ficar prontas.

---

### 2. Automatizar o Ambiente

A AWS oferece ferramentas integradas de monitoramento e automação que devem ser usadas para reduzir falhas manuais e acelerar respostas.

Com automação, você:

- Detecta automaticamente instâncias não íntegras.
- Inicia recursos substitutos sem intervenção humana.
- Notifica administradores automaticamente.
- Mantém registros de mudança realizados pelo ambiente.

**Exemplo:**  
Ao detectar falha em um servidor de aplicações, o CloudWatch aciona o Auto Scaling, que inicia e configura um servidor idêntico e registra a ação automaticamente.

---

### 3. Usar IaC (Infraestrutura como Código)

Provisione infraestrutura usando **código**, em vez de processos manuais.

Vantagens do IaC:

- Implantação rápida de ambientes duplicados.
- Redução de erros de configuração.
- Padronização e consistência entre ambientes.
- Facilidade para reverter versões de infraestrutura.

Com o IaC, basta atualizar o modelo: todas as pilhas recebem a alteração de maneira consistente.  
Ferramentas recomendadas: AWS CloudFormation, AWS CDK, Terraform, Pulumi.

---

### 4. Tratar Recursos como Descartáveis

Aproveite a natureza dinâmica da computação em nuvem.

**Boas práticas:**
- Automatize a implantação de novos recursos com configurações idênticas.
- Encerre recursos que não estão em uso.
- Teste atualizações em novos recursos e depois substitua os antigos pelos atualizados.

A ideia central é **tratar a infraestrutura como software**, não como hardware.  
Com hardware tradicional, você geralmente compra mais do que precisa para picos de uso — isso é caro, inflexível e difícil de atualizar.

Ao tratar recursos como descartáveis:
- A migração entre instâncias é simples.
- Você reage rapidamente a mudanças de capacidade.
- Facilita atualizações e gerenciamento de software.

---

### 5. Usar Componentes com Acoplamento Fraco

Projete arquiteturas com componentes independentes.

**Soluções que promovem desacoplamento:**
- **Balanceadores de carga**, como o Elastic Load Balancing (ELB).
- **Filas de mensagens**, como Amazon SQS.

Com acoplamento forte, quando um componente falha, todo o sistema pode falhar junto.  
Com acoplamento fraco, serviços intermediários lidam automaticamente com falhas e escalabilidade.

**Exemplo de boa prática:**
- Servidores web desacoplados de servidores de aplicação usando o ELB.

**Antipadrão:**
- Servidores web conectados diretamente e de forma rígida aos servidores de aplicação.

---

### 6. Criar Serviços, Não Servidores

Use a variedade de serviços gerenciados da AWS. Não limite tudo a EC2.

**Considere:**
- Contêineres ou soluções serverless quando apropriado.
- Filas de mensagens para comunicação entre aplicações.
- Armazenamento de ativos estáticos no Amazon S3.
- Serviços gerenciados para autenticação e gerenciamento de estado.

Soluções como AWS Lambda, Amazon SQS, DynamoDB, ELB, Amazon SES e Amazon Cognito podem substituir servidores inteiros com custo menor e mais eficiência.

---

### 7. Escolher a Solução de Banco de Dados Ideal

Combine o tipo de banco de dados ao workload — não o contrário.

**Perguntas importantes:**
- Quais são as necessidades de leitura e gravação?
- Qual o total de armazenamento necessário?
- Qual o tamanho típico dos objetos?
- Quais são os requisitos de durabilidade e latência?
- Quantos usuários simultâneos?
- Quais são as necessidades de consulta?
- Qual o nível necessário de integridade dos dados?

A AWS recomenda escolher o armazenamento com base no comportamento da aplicação, e não por limitações de hardware (como ocorre on-premises).

---

### 8. Evitar Pontos Únicos de Falha

Presuma que tudo pode falhar. Projete a arquitetura para suportar falhas.

**Exemplo típico:**
- Dois servidores de aplicação conectados a um único banco de dados → ponto único de falha.
- Solução: criar um banco de dados secundário (standby) e replicar os dados.
- Se o banco principal falhar, o secundário assume automaticamente.

Essa abordagem reforça também o conceito de recursos descartáveis.

---

### 9. Otimizar em Termos de Custo

Aproveite a flexibilidade da nuvem para atingir eficiência financeira.

**Pergunte-se:**
- Meus recursos têm o tamanho e tipo adequados?
- Quais métricas devo monitorar?
- Como desligar recursos não utilizados?
- Com que frequência o recurso será usado?
- Posso substituir servidores por serviços gerenciados?

Lembre-se: replicar na nuvem um data center rodando 24/7 pode ser muito caro.  
Use o modelo pay-as-you-go a seu favor.

---

### 10. Usar Cache

Minimize operações redundantes, reduza custos e melhore a performance.

O cache armazena dados temporariamente entre o usuário e o armazenamento principal.

**Exemplo com CloudFront + S3:**
1. A primeira solicitação verifica no CloudFront; se não encontrar, busca no S3.
2. CloudFront armazena o arquivo no edge.
3. Solicitações subsequentes vêm direto do edge — menor latência e menor custo.

---

### 11. Proteger Toda a Infraestrutura

Promova segurança em todas as camadas.

**Boas práticas:**
- Use serviços gerenciados.
- Registre acessos a recursos.
- Isole partes da infraestrutura.
- Criptografe dados em trânsito e em repouso.
- Aplique controle de acesso com menor privilégio.
- Use MFA.
- Automatize implantações para manter segurança consistente.

Exemplo: em EC2, grupos de segurança podem limitar portas, origem e destino do tráfego, evitando que problemas em uma instância se espalhem.

---

